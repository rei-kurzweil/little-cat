#!/usr/bin/env bash
set -euo pipefail

# Prepares runtime assets:
# - Converts images to BC7 DDS under assets/textures
#
# Usage:
#   ./prepare_assets
#   ./prepare_assets --skip-textures

SCRIPT_DIR="$(cd -- "$(dirname -- "${BASH_SOURCE[0]}")" >/dev/null 2>&1 && pwd)"
REPO_ROOT="$(cd -- "$SCRIPT_DIR/.." >/dev/null 2>&1 && pwd)"

skip_textures=0
texture_args=()

while [[ $# -gt 0 ]]; do
  case "$1" in
    --skip-textures|--skip-dds)
      skip_textures=1
      shift
      ;;
    *)
      texture_args+=("$1")
      shift
      ;;
  esac
done

if [[ $skip_textures -eq 0 ]]; then
  "$REPO_ROOT/assets/convert_images_to_dds" "${texture_args[@]}"
else
  echo "skipping texture conversion"
fi
